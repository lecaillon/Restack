## Restack
Restack is an easy to declare and inject, autogenerated proxy for an HTTP service. The idea is to make a full featured resilient HTTP client. It's inspired by the David Fowler's project [RestSample](https://github.com/davidfowl/RestSample) and forked from Ryan Nowak work on [Kickr](https://github.com/glennc/Kickr).

Its implementation is based on:
- [refit](https://github.com/paulcbetts/refit)
- [Polly](https://github.com/App-vNext/Polly)
- [consul](https://github.com/hashicorp/consul)

### Example

1. Define an interface for your rest service.
    ````csharp
    public interface IGeoApi
    {
        [Get("/regions")]
        Task<IEnumerable<Region>> GetRegionsAsync();
    }
    ````
1. Configure the URL for your service and add some http request headers.
    ```csharp
    public void ConfigureServices(IServiceCollection services)
    {
        services.AddMvc();
        services.AddRestack(); // configure Restack HttpClientFactory

        services.AddRestackGlobalHeaders(o => o.Headers.Add("user-agent", "myagent"));

        services.AddRestClient<IGeoApi>("https://geo.api.gouv.fr")
                .AddRestackHeaders<IGeoApi>(o => o.Headers.Add("api-key", "xxxxx-xxx-xxxxxxxx"));
    }
    ```
1. Consume the interface via RestClient\<T\>.
    ```csharp
    public class HomeController : Controller
    {
        private readonly IGeoApi _geoApi;

        public HomeController(IRestClient<IGeoApi> geoApiClient)
        {
            _geoApi = geoApiClient.Client;
        }

        [HttpGet("/")]
        public async Task<IActionResult> Get()
        {
            var regions = await _geoApi.GetRegionsAsync();

            return Ok(regions);
        }
    }
    ```
